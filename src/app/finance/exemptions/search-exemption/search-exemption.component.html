<div class="search-exemption-container" [class.theme-dark]="currentTheme === 'dark'">
  <div class="search-row">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Search Exemptions</mat-label>
      <mat-icon matPrefix>search</mat-icon>
      <input 
        matInput 
        [formControl]="searchControl"
        [matAutocomplete]="auto"
        placeholder="Search by student name, number, email..."
      />
      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selectExemption($event.option.value)">
        <mat-option *ngFor="let exemption of filteredExemptions" [value]="exemption">
          <div class="autocomplete-option">
            <div class="option-main">
              <span class="student-name">{{ exemption.student.name }} {{ exemption.student.surname }}</span>
              <span class="student-number">({{ exemption.student.studentNumber }})</span>
            </div>
            <div class="option-meta">
              <span class="exemption-type">{{ exemption.type }}</span>
              <span class="exemption-amount" *ngIf="exemption.fixedAmount">
                ${{ exemption.fixedAmount | number:'1.2-2' }}
              </span>
              <span class="exemption-amount" *ngIf="exemption.percentageAmount">
                {{ exemption.percentageAmount }}%
              </span>
            </div>
          </div>
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </div>

  <div class="filter-row">
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Filter by Type</mat-label>
      <mat-select [formControl]="typeControl">
        <mat-option value="">All Types</mat-option>
        <mat-option *ngFor="let type of exemptionTypes" [value]="type">
          {{ type | titlecase | replaceUnderscores }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-checkbox [formControl]="activeControl" [indeterminate]="activeControl.value === null">
      Active Only
    </mat-checkbox>

    <button mat-icon-button (click)="clearFilters()" matTooltip="Clear Filters">
      <mat-icon>clear</mat-icon>
    </button>
  </div>
</div>

